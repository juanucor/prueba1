"use strict";function qlfPromoStarter(a,b){(function(a,b){function c(a,b,c){var e=new Date;e.setTime(e.getTime()+1e3*(60*(60*(24*c))));var d="expires="+e.toUTCString();document.cookie=a+"="+b+";"+d+";path=/"}function d(a){for(var b,d=a+"=",e=document.cookie.split(";"),f=0;f<e.length;f++){for(b=e[f];" "===b.charAt(0);)b=b.substring(1);if(0===b.indexOf(d))return b.substring(d.length,b.length)}return""}function e(a){if(a){const b=a.split(",");return 0===b.length?void 0:b.reduce((a,b)=>{const c=b.split(":"),d={};return d[c[0]]=+c[1],{...a,...d}},{})}}function f(a){if(!a)return;if("object"!=typeof a)return;let b="";return Object.keys(a).forEach((c,d)=>{b+=`${c}:${a[c]}`,d<Object.keys(a).length-1&&(b+=",")}),b}function g(){let a=d(s);return a||(c(s,"c:0,e:0,l:0",30),a=d(s)),a}function h(){const a=g(),b=e(a);return!!b&&b}function i(a,b,d){const e=h();a&&e.c!==void 0&&(e.c+=1),b&&e.e!==void 0&&(e.e=b),d&&e.l!==void 0&&(e.l=d);const g=f(e);g&&c(s,g,30)}function j(a){const b=h();return!(b.c>=a)}function k(){const a=h();return!(1<=a.e)}function l(){const a=h();return!(1<=a.l)}function m(){const a=screen&&screen.orientation?screen.orientation.angle:window.orientation;return(0===a||180===a)&&414>=screen.width||(-90===a||90===a)&&896>=screen.width}function n({clientId:a,siteId:c,trigger:d}){p=d.id,q=d.eId,s=r+q;const e=document.createElement("div");e.setAttribute("id","qlf-promo-loader"),e.style.height=0,document.body.appendChild(e),e.addEventListener("qlf-closed",function(){i(0,1,0)},!1),e.addEventListener("qlf-call-to-action",function(){i(0,0,1)},!1);const f=new XMLHttpRequest,g=new XMLHttpRequest,h=`${b}/triggers/${d.id}?${`c=${a}&s=${c}`}`;f.open("GET",h),f.send(),f.onload=()=>{if(200<=f.status&&300>f.status){const{clientId:a,accessToken:c,campaignId:d,configuration:{stopShowing:i},promoFormat:e,subDomain:h}=JSON.parse(f.responseText);if(i&&"never"!==i.when){if(i.afterBeenShowed&&!j(i.afterBeenShowed))return;if(i.afterClosingPopup&&!k())return;if(i.afterClickToCallToAction&&!l())return}let n=`clientId=${a}&channelId=${d}&token=${c}&promotype=${e}&d=${h}`;m()&&(n+="&layout=mobile");const o=`${b}/promo?${n}`;g.open("GET",o),g.send()}},g.onload=()=>{if(200<=g.status&&300>g.status){const a=new DOMParser,b=a.parseFromString(g.responseText,"text/html");b.getElementsByTagName("html")[0].style.height=0,b.getElementsByTagName("body")[0].style.height=0;const c=b.querySelectorAll("script"),d=b.getElementById("qlf-promo-loader-actions")||c[c.length-1];d.parentNode.removeChild(d);const f=document.createElement("script");f.innerText=d.innerText,e.appendChild(document.adoptNode(b.getElementsByTagName("html")[0])),e.appendChild(f),i(1,0,0)}}}function o(a){const b=new RegExp(a),c=window.location.href.match(b);return null!==c&&0<c.length}let p=0,q=0;const r="qlfpromo-";let s="";a&&a.t&&function(a){for(const b of a.t){let c=!1;for(const a of b.u)if(o(a)){c=!0;break}if(c){n({clientId:a.c,siteId:a.s,trigger:b});break}}}(a)})(a,b)};qlfPromoStarter({}, 'https://participa.nationalgeographic.com.es/v1/loader');